<div class="dashboard-list-container">

  <!-- Header Opcional -->
  @if (showHeader) {
    <div class="list-header">
      <div class="header-content">
        <div class="title-section">
          <h2 class="list-title">
            <i class="bx bx-grid-alt"></i>
            Meus Dashboards
          </h2>
          @if (!loading && dashboards.length > 0) {
            <span class="count-badge">{{ dashboards.length }}</span>
          }
        </div>
        <p class="list-subtitle">
          Olá <b>{{ auth.getUserName() }}</b>,<br>
          Estes são os dashboards que você pode acessar.<br>
          Defina um como principal para que ele seja carregado automaticamente na página inicial ou navegue entre os demais quando quiser.
        </p>

        <!-- Indicador de Dashboard Principal -->
        @if (allowSetHome && hasHomeDashboard()) {
          <div class="home-dashboard-indicator">
            <i class="bx bx-star"></i>
            <span>{{ getHomeDashboard()?.name }}</span>
          </div>
        }
      </div>
    </div>
  }

  <!-- Estado de Loading -->
  @if (loading) {
    <div class="loading-state">
      <div class="spinner"></div>
      <p>Carregando dashboards...</p>
    </div>
  }

  <!-- Estado de Erro -->
  @else if (error) {
    <div class="error-state">
      <div class="error-icon">
        <i class="bx bx-error-circle"></i>
      </div>
      <h3 class="error-title">Não foi possível carregar</h3>
      <p class="error-message">{{ error }}</p>
      <button class="retry-button" (click)="retry()">
        <i class="bx bx-refresh"></i>
        Tentar Novamente
      </button>
    </div>
  }

  <!-- Grid de Dashboards -->
  @else if (dashboards.length > 0) {
    <div class="dashboards-grid" [style.grid-template-columns]="getGridColumns()">
      @for (dashboard of dashboards; track dashboard.key) {
        <div class="dashboard-card" [class.is-home]="dashboard.is_home" (click)="selectDashboard(dashboard)">

          <div class="card-header">
            <!-- Ícone e Badge Principal -->
            <div class="card-icon">
              <i [class]="getIconClass(dashboard)"></i>
              @if (dashboard.is_home) {
                <div class="home-badge"></div>
              }
            </div>

            <!-- Menu de Ações (minimalista) -->
            <div class="card-menu">
              @if (allowSetHome && !dashboard.is_home) {
                <button
                  class="set-home-btn"
                  (click)="setAsHomeDashboard(dashboard, $event)"
                  [disabled]="settingHome[dashboard.key]"
                  title="Definir como principal">
                  @if (settingHome[dashboard.key]) {
                    <i class="bx bx-loader-alt bx-spin"></i>
                  } @else {
                    <i class="bx bx-star"></i>
                  }
                </button>
              }
            </div>
          </div>

          <div class="card-content">
            <h3 class="card-title">{{ dashboard.name }}</h3>
            @if (dashboard.description) {
              <p class="card-description">{{ dashboard.description }}</p>
            }
          </div>

          <!-- Indicador de seleção -->
          <div class="card-footer">
            <span class="select-hint">
              <i class="bx bx-chevron-right"></i>
              Visualizar
            </span>
          </div>
        </div>
      }
    </div>
  }

  <!-- Estado Vazio -->
  @else {
    <div class="empty-state">
      <div class="empty-icon">
        <i class="bx bx-bar-chart-alt-2"></i>
      </div>
      <h3>Nenhum dashboard disponível</h3>
      <p>Você ainda não tem acesso a nenhum dashboard</p>
    </div>
  }

</div>
